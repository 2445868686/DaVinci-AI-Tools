<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DaVinci Resolve Sub Tool 安装与使用指南 / EN</title>

  <!-- ===== Shared Styles ===== -->
  <style>
    /* Global font and background */
    body {
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f2f5;
      color: #555;
    }

    /* Fixed left navigation */
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 250px;
      height: 100%;
      background: #fff;
      border-right: 1px solid #e0e0e0;
      padding: 20px;
      overflow-y: auto;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
    }
    .sidebar h2 {
      font-size: 1.8em;
      margin: 0 0 20px;
      color: #333;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
      padding-bottom: 10px;
    }
    .sidebar ul {
      list-style: none;
      padding: 0;
    }
    .sidebar li {
      margin: 10px 0;
      font-size: 0.95em;
    }
    .sidebar li ul {
      margin-top: 5px;
      margin-left: 15px;
    }
    .sidebar a {
      text-decoration: none;
      color: #007bff;
      transition: color 0.3s;
    }
    .sidebar a:hover {
      color: #0056b3;
    }

    /* Main content area */
    .content {
      margin-left: 270px;
      padding: 40px;
    }

    /* Card container */
    .container {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 30px;
      margin-bottom: 40px;
    }
    header {
      text-align: center;
      padding-bottom: 20px;
      border-bottom: 1px solid #e0e0e0;
      margin-bottom: 30px;
    }
    header h1 {
      margin: 0;
      font-size: 2em;
      color: #333;
    }
    h2 {
      color: #007bff;
      margin-top: 30px;
      border-left: 4px solid #007bff;
      padding-left: 10px;
    }
    h3 {
      color: #333;
      margin-top: 20px;
    }
    p,
    ul {
      line-height: 1.8;
      margin: 15px 0;
    }
    ul {
      padding-left: 20px;
    }
    code {
      background: #f9f9f9;
      padding: 4px 8px;
      border-radius: 4px;
      font-family: Consolas, Monaco, "Courier New", monospace;
    }
    pre {
      background: #f9f9f9;
      padding: 15px;
      border-left: 5px solid #007bff;
      border-radius: 4px;
      overflow-x: auto;
      font-family: Consolas, Monaco, "Courier New", monospace;
    }
    a {
      color: #007bff;
    }
    footer {
      text-align: center;
      font-size: 0.9em;
      color: #888;
      margin-top: 40px;
      border-top: 1px solid #e0e0e0;
      padding-top: 20px;
    }

    /* Mobile */
    @media (max-width: 768px) {
      .sidebar {
        position: relative;
        width: 100%;
        height: auto;
        box-shadow: none;
        border-right: none;
        border-bottom: 1px solid #e0e0e0;
      }
      .content {
        margin-left: 0;
        padding: 20px;
      }
    }

    /* Language toggles */
    .lang {
      display: none;
    }
    .lang.active {
      display: block;
    }

    .lang-switcher {
      position: fixed;
      top: 15px;
      right: 20px;
      z-index: 1000;
    }
    .lang-switcher button {
      cursor: pointer;
      border: 1px solid #007bff;
      background: #fff;
      color: #007bff;
      font-size: 0.9em;
      padding: 6px 12px;
      border-radius: 20px;
      transition: all 0.3s;
      margin-left: 6px;
    }
    .lang-switcher button.active,
    .lang-switcher button:hover {
      background: #007bff;
      color: #fff;
    }
  </style>
</head>

<body>
  <div class="lang-switcher">
    <button id="btn-zh" class="active">中文</button>
    <button id="btn-en">English</button>
  </div>

  <!-- ===== Chinese Version ===== -->
  <div id="lang-zh" class="lang active">
    <nav class="sidebar">
      <h2>目录</h2>
      <ul>
        <li>
          <strong>安装指南</strong>
          <ul>
            <li><a href="#install-step-1">步骤 1：复制脚本文件</a></li>
            <li><a href="#install-step-2">步骤 2：在 Resolve 中启用</a></li>
          </ul>
        </li>
        <li>
          <strong>使用指南</strong>
          <ul>
            <li><a href="#overview-zh">1. 功能简介</a></li>
            <li><a href="#interface-zh">2. 界面结构</a></li>
            <li><a href="#refresh-zh">3. 刷新并浏览字幕</a></li>
            <li><a href="#search-zh">4. 查找与替换</a></li>
            <li><a href="#edit-zh">5. 编辑并写回时间线</a></li>
            <li><a href="#translate-zh">6. 翻译功能</a></li>
            <li><a href="#settings-zh">7. 设置</a></li>
            <li><a href="#faq-zh">8. 常见问题</a></li>
          </ul>
        </li>
      </ul>
    </nav>

    <div class="content">
      <div class="container" id="install-guide-zh">
        <header>
          <h1>DaVinci Resolve Sub Tool 安装指南</h1>
        </header>
        <section id="install-step-1">
          <h2>步骤 1：复制脚本文件</h2>
          <p>将 <code>DaVinci Sub Tool</code> 文件夹放入 Resolve 脚本目录。如果本文件与脚本已经位于同一目录，可直接跳过。</p>
          <h3>Windows 路径</h3>
          <p><code>C:\ProgramData\Blackmagic Design\DaVinci Resolve\Fusion\Scripts\Utility</code></p>
          <h3>macOS 路径</h3>
          <p><code>~/Library/Application Support/Blackmagic Design/DaVinci Resolve/Fusion/Scripts/Utility</code></p>
        </section>
        <section id="install-step-2">
          <h2>步骤 2：在 Resolve 中启用</h2>
          <ul>
            <li>启动或切回 DaVinci Resolve。</li>
            <li>打开含有字幕轨的时间线。</li>
            <li>依次选择 <code>工作区</code> &gt; <code>脚本</code>  &gt; <strong>DaVinci Sub Tool</strong>。</li>
          </ul>
        </section>
      </div>

      <div class="container" id="usage-guide-zh">
        <header>
          <h1>DaVinci Resolve Sub Tool 使用指南</h1>
        </header>
        <section id="overview-zh">
          <h2>功能简介</h2>
          <p>DaVinci Sub Tool 通过 Resolve Lua API 直接读取当前时间线字幕，提供检索、批量替换、逐条编辑、时间线跳转以及一键写回等功能。工具内置中英文界面，可在脱网环境下工作，适合审校和批处理字幕内容。</p>
        </section>
        <section id="interface-zh">
          <h2>界面结构</h2>
          <ul>
            <li><strong>查找替换区</strong>：包含查找/替换输入框和 <code>查找</code>、<code>全部替换</code>、<code>替换</code> 按钮。</li>
            <li><strong>字幕列表</strong>：树状列表展示编号、起止时间码、字幕文本，支持单选和高亮。</li>
            <li><strong>编辑器</strong>：下方文本框用于直接修改选中字幕，内容会同步回列表。</li>
            <li><strong>状态栏</strong>：显示加载进度、匹配统计、导入结果等提示。</li>
            <li><strong>操作按钮</strong>：底部的 <code>加载当前字幕</code> 与 <code>更新当前字幕</code> 控制读取与写回流程。</li>
          </ul>
        </section>
        <section id="refresh-zh">
          <h2>刷新并浏览字幕</h2>
          <ul>
            <li>点击 <code>加载当前字幕</code>，脚本会定位当前工程与时间线。</li>
            <li>工具会寻找首个启用且包含字幕片段的字幕轨，读取其所有条目并按开始帧排序。</li>
            <li>列表中会显示起止时间码与文本，同时在状态栏提示已加载的字幕总数。</li>
            <li>单击任意条目，时间线播放头会跳转至对应字幕开头，方便核对画面。</li>
            <li>若未检测到字幕轨，会在状态栏提示，请确认时间线中启用了至少一条字幕轨。</li>
          </ul>
        </section>
        <section id="search-zh">
          <h2>查找与替换</h2>
          <ul>
            <li>在「查找文本」输入关键字，按 Enter 或点击 <code>查找</code>，即可循环定位匹配字幕。</li>
            <li>查找采用纯文本匹配（区分大小写），命中的行会以深灰背景高亮。</li>
            <li><code>全部替换</code> 用于一次性修改所有匹配项，并保留高亮以便复核。</li>
            <li><code>替换</code> 仅作用于当前选中的匹配项，方便逐条确认。</li>
            <li>状态栏会同时展示匹配到的行数与总出现次数，便于评估替换范围。</li>
          </ul>
        </section>
        <section id="edit-zh">
          <h2>编辑并写回时间线</h2>
          <ul>
            <li>在编辑器中直接修改字幕文本，列表会即时同步，避免遗漏。</li>
            <li>确认无误后，点击 <code>更新当前字幕</code>，脚本会生成新的 SRT 文件并导入时间线。</li>
            <li>导入流程会创建或复用媒体库根目录下的 <code>srt</code> 子文件夹，并将最新 SRT 放入其中。</li>
            <li>写回期间其余字幕轨会临时禁用，避免重复叠加，完成后自动恢复原状态。</li>
            <li>写回成功会提示「更新完成」，若导入失败或时间线被锁定，会在状态栏给出原因。</li>
          </ul>
        </section>
        <section id="translate-zh">
          <h2>翻译功能</h2>
          <p>工具集成了多种翻译服务，可快速为字幕生成译文。</p>
          <ul>
            <li><strong>服务商选择</strong>：在“翻译”选项卡中，从下拉菜单选择翻译服务，如 Microsoft、SiliconFlow (免费AI)、GLM-4-Flash (免费AI) 或自定义的 OpenAI 兼容 API。</li>
            <li><strong>目标语言</strong>：选择期望翻译成的语言。</li>
            <li><strong>开始翻译</strong>：点击 <code>开始翻译</code> 按钮，工具会逐条或并发翻译所有字幕。进度和预估的 token 消耗会显示在状态栏。</li>
            <li><strong>翻译选中</strong>：如果只想翻译特定几行，可在列表中选中它们，然后点击 <code>翻译选中行</code>。</li>
            <li><strong>译文编辑</strong>：翻译完成后，译文会出现在右侧列。你可以像编辑原文一样，在下方的编辑器中对译文进行修改。</li>
            <li><strong>导入译文</strong>：点击 <code>译文导入时间线</code>，工具会将所有译文作为一条新的字幕轨添加到时间线，并禁用其它字幕轨，方便导出或审校。</li>
          </ul>
        </section>
        <section id="settings-zh">
          <h2>设置</h2>
          <p>“设置”选项卡允许你配置 API 密钥和其它参数。</p>
          <ul>
            <li><strong>API 配置</strong>：为 Microsoft Azure 或 OpenAI Format 等需要密钥的服务，点击 <code>配置</code> 按钮，在弹窗中填入你的 API Key、区域或 Base URL。</li>
            <li><strong>OpenAI 兼容模型</strong>：对于 OpenAI Format，你可以添加任何兼容其 API 格式的模型（如 Groq、Together.ai 等）。点击 <code>新增模型</code>，填写显示名称和模型 ID，然后 <code>验证</code> 并保存。</li>
            <li><strong>并发模式</strong>：调整翻译请求的并发程度。“高速”模式能显著加快批量翻译速度，但对免登录的 AI 服务可能会因请求频率过高而失败。</li>
            <li><strong>界面语言</strong>：在设置页可以切换 UI 的中/英文显示。</li>
          </ul>
        </section>
        <section id="faq-zh">
          <h2>常见问题</h2>
          <h3>脚本没有读取到字幕？</h3>
          <p>请确认时间线存在至少一条字幕轨，并且该轨已启用。如果字幕全部位于禁用轨，请手动开启后再次点击 <code>加载当前字幕</code>。</p>
          <h3>写回后字幕顺序不对？</h3>
          <p>脚本会按开始帧排序写入；请检查时间码是否正确或是否存在重叠的字幕片段。</p>
          <h3>想保留导出的 SRT？</h3>
          <p>写回过程中生成的 SRT 位于脚本目录的 <code>temp</code> 文件夹，窗口关闭时会自动删除。可在关闭前复制到其它路径。</p>
        </section>
      </div>

      <footer>&copy; 2025 HB. All Rights Reserved.</footer>
    </div>
  </div>

  <!-- ===== English Version ===== -->
  <div id="lang-en" class="lang">
    <nav class="sidebar">
      <h2>Contents</h2>
      <ul>
        <li>
          <strong>Installation Guide</strong>
          <ul>
            <li><a href="#install-step-1-en">Step 1: Copy the Script</a></li>
            <li><a href="#install-step-2-en">Step 2: Enable inside Resolve</a></li>
          </ul>
        </li>
        <li>
          <strong>Usage Guide</strong>
          <ul>
            <li><a href="#overview-en">1. Overview</a></li>
            <li><a href="#interface-en">2. Interface Layout</a></li>
            <li><a href="#refresh-en">3. Refresh &amp; Browse</a></li>
            <li><a href="#search-en">4. Find &amp; Replace</a></li>
            <li><a href="#edit-en">5. Edit &amp; Update Timeline</a></li>
            <li><a href="#translate-en">6. Translation</a></li>
            <li><a href="#settings-en">7. Settings</a></li>
            <li><a href="#faq-en">8. FAQ</a></li>
          </ul>
        </li>
      </ul>
    </nav>

    <div class="content">
      <div class="container" id="install-guide-en">
        <header>
          <h1>DaVinci Resolve Sub Tool Installation Guide</h1>
        </header>
        <section id="install-step-1-en">
          <h2>Step 1: Copy the Script</h2>
          <p>Place <code>DaVinci Sub Tool</code> Folder inside Resolve's script directory. If the file already lives next to this guide you can skip the copy.</p>
          <h3>Windows Path</h3>
          <p><code>C:\ProgramData\Blackmagic Design\DaVinci Resolve\Fusion\Scripts\Utility</code></p>
          <h3>macOS Path</h3>
          <p><code>~/Library/Application Support/Blackmagic Design/DaVinci Resolve/Fusion/Scripts/Utility</code></p>
        </section>
        <section id="install-step-2-en">
          <h2>Step 2: Enable inside Resolve</h2>
          <ul>
            <li>Launch DaVinci Resolve and open the timeline containing subtitles.</li>
            <li>Navigate to <code>Workspace</code> &gt; <code>Scripts</code> &gt; <strong>DaVinci Sub Tool</strong>.</li>
          </ul>
        </section>
      </div>

      <div class="container" id="usage-guide-en">
        <header>
          <h1>DaVinci Resolve Sub Tool Usage Guide</h1>
        </header>
        <section id="overview-en">
          <h2>Overview</h2>
          <p>DaVinci Sub Tool reads the subtitles of the active timeline via the Resolve scripting API, giving you tools to review, search, batch replace, edit, jump the playhead, and push the changes back in one click. The tool ships with Chinese and English UI packs and works offline.</p>
        </section>
        <section id="interface-en">
          <h2>Interface Layout</h2>
          <ul>
            <li><strong>Find/Replace Strip</strong>: Enter search and replacement text, then trigger <code>Find</code>, <code>All Replace</code>, or <code>Replace</code>.</li>
            <li><strong>Subtitle Tree</strong>: Displays index, start/end timecodes, and text with single-selection highlighting.</li>
            <li><strong>Editor Panel</strong>: Edit the selected subtitle directly; the tree updates instantly.</li>
            <li><strong>Status Line</strong>: Reports loading progress, match statistics, and import results.</li>
            <li><strong>Action Buttons</strong>: <code>Load Timeline Subtitles</code> refreshes data, <code>Update Timeline Subtitles</code> writes changes back.</li>
          </ul>
        </section>
        <section id="refresh-en">
          <h2>Refresh &amp; Browse</h2>
          <ul>
            <li>Click <code>Load Timeline Subtitles</code> to bind to the active project and timeline.</li>
            <li>The script selects the first enabled subtitle track that contains clips and sorts entries by start frame.</li>
            <li>Each row shows timecodes and text, while the status line confirms how many subtitles were loaded.</li>
            <li>Selecting a row jumps the playhead to that subtitle's start frame so you can review the visuals.</li>
            <li>If no subtitle track is found, the status line prompts you to enable one before retrying.</li>
          </ul>
        </section>
        <section id="search-en">
          <h2>Find &amp; Replace</h2>
          <ul>
            <li>Type a keyword in the Find field and press Enter or click <code>Find</code> to cycle through matches.</li>
            <li>The search is plain-text and case-sensitive; matching rows receive a dark gray highlight.</li>
            <li><code>All Replace</code> updates every match at once and keeps the highlight so you can double-check.</li>
            <li><code>Replace</code> targets only the current match, making it safe for line-by-line review.</li>
            <li>The status line reports both the number of rows and total occurrences that were matched.</li>
          </ul>
        </section>
        <section id="edit-en">
          <h2>Edit &amp; Update Timeline</h2>
          <ul>
            <li>Edit the subtitle in the lower text area; the tree mirrors the change immediately.</li>
            <li>When satisfied, click <code>Update Timeline Subtitles</code>. A new SRT is generated and imported.</li>
            <li>The media pool stores the SRT inside an <code>srt</code> folder under the root before appending it to the subtitle track.</li>
            <li>Other subtitle tracks are temporarily disabled during the import to avoid stacking duplicates, and restored afterwards.</li>
            <li>Success, failures, or locked-track warnings are displayed in the status line.</li>
          </ul>
        </section>
        <section id="translate-en">
          <h2>Translation</h2>
          <p>The tool integrates multiple translation services to quickly generate translated subtitles.</p>
          <ul>
            <li><strong>Provider Selection</strong>: In the "Translate" tab, choose a provider from the dropdown, such as Microsoft, SiliconFlow (Free AI), GLM-4-Flash (Free AI), or a custom OpenAI-compatible API.</li>
            <li><strong>Target Language</strong>: Select the desired target language.</li>
            <li><strong>Start Translation</strong>: Click <code>Translate</code> to process all subtitles. Progress and estimated token usage are shown in the status bar.</li>
            <li><strong>Translate Selected</strong>: To translate only specific lines, select them in the list and click <code>Translate Selected</code>.</li>
            <li><strong>Edit Translation</strong>: Once complete, translations appear in the right-hand column. You can edit them in the editor below, just like the original text.</li>
            <li><strong>Import Translation</strong>: Click <code>Import Translation to Timeline</code> to add the translated text as a new subtitle track, disabling others for a clean export or review.</li>
          </ul>
        </section>
        <section id="settings-en">
          <h2>Settings</h2>
          <p>The "Settings" tab allows you to configure API keys and other parameters.</p>
          <ul>
            <li><strong>API Configuration</strong>: For services requiring a key, like Microsoft Azure or OpenAI Format, click <code>Config</code> to enter your API Key, Region, or Base URL in the dialog.</li>
            <li><strong>OpenAI-Compatible Models</strong>: For the OpenAI Format, you can add any API-compatible model (e.g., from Groq, Together.ai). Click <code>Add Model</code>, enter a display name and model ID, then <code>Verify</code> and save.</li>
            <li><strong>Concurrency Mode</strong>: Adjust the level of parallel translation requests. "High" mode can significantly speed up batch translations but may fail with free AI services due to rate limits.</li>
            <li><strong>UI Language</strong>: Switch the UI between Chinese and English in the settings tab.</li>
          </ul>
        </section>
        <section id="faq-en">
          <h2>FAQ</h2>
          <h3>No subtitles were loaded.</h3>
          <p>Ensure at least one subtitle track is enabled on the timeline and contains clips, then click <code>Load Timeline Subtitles</code> again.</p>
          <h3>The order looks wrong after updating.</h3>
          <p>The script writes entries sorted by start frame. Check your timecodes and resolve any overlapping segments.</p>
          <h3>How do I keep the exported SRT?</h3>
          <p>Exports live in the <code>temp</code> folder next to the script until the window closes. Copy the file elsewhere before exiting the tool.</p>
        </section>
      </div>

      <footer>&copy; 2025 HB. All Rights Reserved.</footer>
    </div>
  </div>

  <!-- ===== Language Switch Script ===== -->
  <script>
    const btnZh = document.getElementById("btn-zh");
    const btnEn = document.getElementById("btn-en");
    const langZh = document.getElementById("lang-zh");
    const langEn = document.getElementById("lang-en");

    btnZh.addEventListener("click", () => {
      btnZh.classList.add("active");
      btnEn.classList.remove("active");
      langZh.classList.add("active");
      langEn.classList.remove("active");
      document.documentElement.lang = "zh-CN";
    });

    btnEn.addEventListener("click", () => {
      btnEn.classList.add("active");
      btnZh.classList.remove("active");
      langEn.classList.add("active");
      langZh.classList.remove("active");
      document.documentElement.lang = "en";
    });
  </script>
</body>
</html>