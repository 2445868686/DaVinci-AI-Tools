<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DaVinci Batch Render 安装与使用指南 / EN</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f2f5;
      color: #555;
    }
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 250px;
      height: 100%;
      background: #fff;
      border-right: 1px solid #e0e0e0;
      padding: 20px;
      overflow-y: auto;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
    }
    .sidebar h2 {
      font-size: 1.8em;
      margin: 0 0 20px;
      color: #333;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
      padding-bottom: 10px;
    }
    .sidebar ul {
      list-style: none;
      padding: 0;
    }
    .sidebar li {
      margin: 10px 0;
      font-size: 0.95em;
    }
    .sidebar li ul {
      margin-top: 5px;
      margin-left: 15px;
    }
    .sidebar a {
      text-decoration: none;
      color: #007bff;
      transition: color 0.3s;
    }
    .sidebar a:hover {
      color: #0056b3;
    }
    .content {
      margin-left: 270px;
      padding: 40px;
    }
    .container {
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 30px;
      margin-bottom: 40px;
    }
    header {
      text-align: center;
      padding-bottom: 20px;
      border-bottom: 1px solid #e0e0e0;
      margin-bottom: 30px;
    }
    header h1 {
      margin: 0;
      font-size: 2em;
      color: #333;
    }
    h2 {
      color: #007bff;
      margin-top: 30px;
      border-left: 4px solid #007bff;
      padding-left: 10px;
    }
    h3 {
      color: #333;
      margin-top: 20px;
    }
    p,
    ul {
      line-height: 1.8;
      margin: 15px 0;
    }
    ul {
      padding-left: 20px;
    }
    code {
      background: #f9f9f9;
      padding: 4px 8px;
      border-radius: 4px;
      font-family: Consolas, Monaco, "Courier New", monospace;
    }
    footer {
      text-align: center;
      font-size: 0.9em;
      color: #888;
      margin-top: 40px;
      border-top: 1px solid #e0e0e0;
      padding-top: 20px;
    }
    @media (max-width: 768px) {
      .sidebar {
        position: relative;
        width: 100%;
        height: auto;
        box-shadow: none;
        border-right: none;
        border-bottom: 1px solid #e0e0e0;
      }
      .content {
        margin-left: 0;
        padding: 20px;
      }
    }
    .lang {
      display: none;
    }
    .lang.active {
      display: block;
    }
    .lang-switcher {
      position: fixed;
      top: 15px;
      right: 20px;
      z-index: 1000;
    }
    .lang-switcher button {
      cursor: pointer;
      border: 1px solid #007bff;
      background: #fff;
      color: #007bff;
      font-size: 0.9em;
      padding: 6px 12px;
      border-radius: 20px;
      transition: all 0.3s;
      margin-left: 6px;
    }
    .lang-switcher button.active,
    .lang-switcher button:hover {
      background: #007bff;
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="lang-switcher">
    <button id="btn-zh" class="active">中文</button>
    <button id="btn-en">English</button>
  </div>

  <div id="lang-zh" class="lang active">
    <nav class="sidebar">
      <h2>目录</h2>
      <ul>
        <li>
          <strong>安装指南</strong>
          <ul>
            <li><a href="#install-step-1-zh">步骤 1：复制脚本文件</a></li>
            <li><a href="#install-step-2-zh">步骤 2：在 Resolve 中启用</a></li>
          </ul>
        </li>
        <li>
          <strong>使用指南</strong>
          <ul>
            <li><a href="#overview-zh">功能简介</a></li>
            <li><a href="#markers-zh">准备标记</a></li>
            <li><a href="#queue-zh">生成渲染队列</a></li>
            <li><a href="#output-zh">配置输出与命名</a></li>
            <li><a href="#render-zh">启动批量渲染</a></li>
            <li><a href="#faq-zh">常见问题</a></li>
          </ul>
        </li>
      </ul>
    </nav>

    <div class="content">
      <div class="container" id="install-guide-zh">
        <header>
          <h1>DaVinci Batch Render 安装指南</h1>
        </header>
        <section id="install-step-1-zh">
          <h2>步骤 1：复制脚本文件</h2>
          <p>将 <code>DaVinci Batch Render</code> 文件夹复制到 Resolve 的脚本目录。</p>
          <h3>Windows 路径</h3>
          <p><code>C:\ProgramData\Blackmagic Design\DaVinci Resolve\Fusion\Scripts\Utility</code></p>
          <h3>macOS 路径</h3>
          <p><code>~/Library/Application Support/Blackmagic Design/DaVinci Resolve/Fusion/Scripts/Utility</code></p>
        </section>
        <section id="install-step-2-zh">
          <h2>步骤 2：在 Resolve 中启用</h2>
          <ul>
            <li>启动 DaVinci Resolve。</li>
            <li>选择 <code>菜单栏 &gt; 工作区 &gt; 脚本</code>，点击 <strong>DaVinci Batch Render</strong>。</li>
          </ul>
        </section>
      </div>

      <div class="container" id="usage-guide-zh">
        <header>
          <h1>DaVinci Batch Render 使用指南</h1>
        </header>
        <section id="overview-zh">
          <h2>功能简介</h2>
          <p>DaVinci Batch Render 通过读取当前时间线的 Mark，将两两 Mark 之间包含画面的区间转换为渲染任务，自动切换到 Deliver 页面并顺序执行渲染，适合把长节目拆成多个文件导出。</p>
          <ul>
            <li>支持一键平均分布 Mark 或沿用你手动放置的 Mark。</li>
            <li>渲染树展示区间序号、起止时间码、命名与实时状态/进度。</li>
            <li>输出目录与文件前缀在 UI 中配置，其余渲染参数沿用 Deliver 页。</li>
          </ul>
        </section>
        <section id="markers-zh">
          <h2>准备标记</h2>
          <ul>
            <li>在时间线上定位到想要拆分的位置，确保素材已经整理完毕。</li>
            <li>点击 <code>添加 Mark</code>，脚本会根据 <code>间隔(秒)</code> 与 <code>数量</code> 生成等间隔的 Mark。</li>
            <li>也可以混用手工 Mark；脚本只会在关闭窗口时清理自己生成的 Mark，其他 Mark 保持不变。</li>
            <li>区间由相邻两个 Mark 定义，因此至少需要 2 个 Mark，数量越多，生成的片段越多。</li>
          </ul>
        </section>
        <section id="queue-zh">
          <h2>生成渲染队列</h2>
          <ul>
            <li>完成标记后点击 <code>获取渲染队列</code>。</li>
            <li>脚本会遍历时间线上的所有 Mark，排除没有视频画面的区间，并把有效区间写入渲染树。</li>
            <li>若某段没有覆盖到任何视频剪辑，会在日志中提示“区间 xx - xx 内无视频片段，已跳过”。</li>
            <li>渲染树中的任意行都可以单击，高亮后 Resolve 会跳到该区间的开始帧并自动设置 Mark In/Out，方便复核。</li>
          </ul>
        </section>
        <section id="output-zh">
          <h2>配置输出与命名</h2>
          <ul>
            <li><code>浏览</code> 按钮调用系统目录选择器，所选路径会写入输出目录字段并在日志中提示。</li>
            <li><code>文件名前缀</code> 决定渲染输出的命名，脚本会自动附加 <code>_001</code>、<code>_002</code>……。</li>
            <li>输出目录与前缀在启动渲染前必须填写，否则脚本会记录提示并终止。</li>
            <li>编码、分辨率、音轨等 Deliver 设置全部沿用当前页面，请在点击 <code>开始渲染</code> 前确认无误。</li>
          </ul>
        </section>
        <section id="render-zh">
          <h2>启动批量渲染</h2>
          <ul>
            <li>点击 <code>开始渲染</code> 之前，确保渲染树已经显示所有区间且输出目录合法。</li>
            <li>所有区间完成后，脚本会清理已提交的作业并在日志中提示“渲染序列已完成”。</li>
          </ul>
        </section>
        <section id="faq-zh">
          <h2>常见问题</h2>
          <h3>提示“至少需要两个 Mark 才能生成区间”。</h3>
          <p>请在时间线中放置两个或以上的 Mark（可以使用脚本的 <code>添加 Mark</code> 按钮），然后再次点击 <code>获取渲染队列</code>。</p>
          <h3>日志提示某些区间被跳过。</h3>
          <p>脚本会检测区间内是否存在视频或音频片段。如果区间仅包含空白，系统会跳过该段并在日志中说明开始/结束时间。</p>
          <h3>开始渲染时提示需要输出目录或文件名前缀。</h3>
          <p>请先使用 <code>浏览</code> 选择一个可写入的目录，并在 <code>文件名前缀</code> 输入名称；两者缺一不可。</p>
        </section>
      </div>
      <footer>&copy; 2025 HB. All Rights Reserved.</footer>
    </div>
  </div>

  <div id="lang-en" class="lang">
    <nav class="sidebar">
      <h2>Contents</h2>
      <ul>
        <li>
          <strong>Installation</strong>
          <ul>
            <li><a href="#install-step-1-en">Step 1: Copy the Script</a></li>
            <li><a href="#install-step-2-en">Step 2: Enable inside Resolve</a></li>
          </ul>
        </li>
        <li>
          <strong>Usage</strong>
          <ul>
            <li><a href="#overview-en">Overview</a></li>
            <li><a href="#markers-en">Prepare Markers</a></li>
            <li><a href="#queue-en">Build the Queue</a></li>
            <li><a href="#output-en">Output &amp; Naming</a></li>
            <li><a href="#render-en">Start Rendering</a></li>
            <li><a href="#faq-en">FAQ</a></li>
          </ul>
        </li>
      </ul>
    </nav>

    <div class="content">
      <div class="container" id="install-guide-en">
        <header>
          <h1>DaVinci Batch Render Installation Guide</h1>
        </header>
        <section id="install-step-1-en">
          <h2>Step 1: Copy the Script</h2>
          <p>Copy the <code>DaVinci Batch Render</code> folder into Resolve's script directory.</p>
          <h3>Windows Path</h3>
          <p><code>C:\ProgramData\Blackmagic Design\DaVinci Resolve\Fusion\Scripts\Utility</code></p>
          <h3>macOS Path</h3>
          <p><code>~/Library/Application Support/Blackmagic Design/DaVinci Resolve/Fusion/Scripts/Utility</code></p>
        </section>
        <section id="install-step-2-en">
          <h2>Step 2: Enable inside Resolve</h2>
          <ul>
            <li>Launch DaVinci Resolve.</li>
            <li>Navigate to <code>Workspace &gt; Scripts</code> and click <strong>DaVinci Batch Render</strong>.</li>
          </ul>
        </section>
      </div>

      <div class="container" id="usage-guide-en">
        <header>
          <h1>DaVinci Batch Render Usage Guide</h1>
        </header>
        <section id="overview-en">
          <h2>Overview</h2>
          <p>DaVinci Batch Render reads markers on the active timeline, converts every media-filled range between two markers into a render job, switches to the Deliver page, and renders each segment sequentially—ideal for splitting long programs into multiple exports.</p>
          <ul>
            <li>Create evenly spaced markers with one click or reuse the markers you already placed.</li>
            <li>The render tree lists each segment's index, timecodes, file name, and live status/progress.</li>
            <li>The UI controls only the output folder and filename prefix; all other Deliver settings remain untouched.</li>
          </ul>
        </section>
        <section id="markers-en">
          <h2>Prepare Markers</h2>
          <ul>
            <li>Park the playhead where you want to split the program and make sure the edit is locked.</li>
            <li>Click <code>Add Marks</code> to generate evenly spaced markers using the current <code>Interval (s)</code> and <code>Count</code>.</li>
            <li>You can mix in manual markers; the script only removes the markers it created when the window closes.</li>
            <li>Every pair of markers defines one range, so you need at least two markers before rendering.</li>
          </ul>
        </section>
        <section id="queue-en">
          <h2>Build the Render Queue</h2>
          <ul>
            <li>Click <code>Load Queue</code> after the markers are in place.</li>
            <li>The script scans all markers, drops ranges that contain no video, and fills the render tree with the valid ones.</li>
            <li>Skipped ranges are logged as “Segment xx - xx contains no video and was skipped.”</li>
            <li>Select any row to highlight it—the playhead jumps to the start frame and Mark In/Out is applied automatically.</li>
          </ul>
        </section>
        <section id="output-en">
          <h2>Output &amp; Naming</h2>
          <ul>
            <li>Use <code>Browse</code> to pick a folder; the choice updates <code>TargetDir</code> and is echoed in the log.</li>
            <li>Set the <code>Filename Prefix</code>; the script appends <code>_001</code>, <code>_002</code>, etc. automatically.</li>
            <li>Both the folder and prefix are required before rendering; missing values abort the run with a log message.</li>
            <li>All Deliver settings (codec, resolution, audio) are reused as-is, so verify them before pressing <code>Start Render</code>.</li>
          </ul>
        </section>
        <section id="render-en">
          <h2>Start Rendering</h2>
          <ul>
            <li>Ensure the render tree lists every segment and the output folder is valid, then click <code>Start Render</code>.</li>
            <li>When all segments finish, the script clears the submitted jobs and logs “Render sequence finished.”</li>
          </ul>
        </section>
        <section id="faq-en">
          <h2>FAQ</h2>
          <h3>“At least two markers are required” keeps appearing.</h3>
          <p>Add two or more markers (or press <code>Add Marks</code>) and run <code>Load Queue</code> again.</p>
          <h3>Some ranges are skipped in the log.</h3>
          <p>The script checks for media inside each range. Empty ranges are skipped deliberately, and the start/end timecodes are logged.</p>
          <h3>Start Render complains about the output path or prefix.</h3>
          <p>Use <code>Browse</code> to select a writable folder and fill in <code>Filename Prefix</code>; both fields are mandatory.</p>
        </section>
      </div>
      <footer>&copy; 2025 HB. All Rights Reserved.</footer>
    </div>
  </div>

  <script>
    const btnZh = document.getElementById("btn-zh");
    const btnEn = document.getElementById("btn-en");
    const langZh = document.getElementById("lang-zh");
    const langEn = document.getElementById("lang-en");

    btnZh.addEventListener("click", () => {
      btnZh.classList.add("active");
      btnEn.classList.remove("active");
      langZh.classList.add("active");
      langEn.classList.remove("active");
      document.documentElement.lang = "zh-CN";
    });

    btnEn.addEventListener("click", () => {
      btnEn.classList.add("active");
      btnZh.classList.remove("active");
      langEn.classList.add("active");
      langZh.classList.remove("active");
      document.documentElement.lang = "en";
    });
  </script>
</body>
</html>
